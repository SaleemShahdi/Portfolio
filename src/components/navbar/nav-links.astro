---
import { NAV_LINKS } from "@/lib/constants/index";
import { cn } from "@/lib/utils";

const pathname = Astro.url.pathname;

const isActive = (href: string) => {
  // Normalize the current page's path by removing any trailing slash.
  const cleanCurrentPath = pathname.endsWith('/') && pathname.length > 1 
    ? pathname.slice(0, -1) 
    : pathname;

  // Normalize the link's href for comparison.
  const cleanHref = href.endsWith('/') && href.length > 1 
    ? href.slice(0, -1) 
    : href;

  // For the homepage, we need an exact match to prevent it from matching other pages.
  if (cleanHref === '/Portfolio') {
    return cleanCurrentPath === '/Portfolio';
  }

  // For all other pages (like /projects, /articles), we check if the current path starts with the link's href.
  return cleanCurrentPath.startsWith(cleanHref);
};
---

<div class="flex items-center justify-center gap-4">
  {
    NAV_LINKS.map(link => (
      <a
        href={link.href}
        class={cn(
          "group relative flex flex-col items-center justify-center text-xs font-medium text-foreground/70 duration-150 hover:text-primary lg:text-sm"
        )}
      >
        <span class={cn("mb", isActive(link.href) && "text-primary")}>
          {link.label}
        </span>
      </a>
    ))
  }
</div>